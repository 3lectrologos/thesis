\chapter{Detailed Proofs (Ch. 4)}

\section{Ising Model on the Complete Graph}

\subsection{Bounds on Gibbs mixing}
\let\oldthetheorem\thetheorem
\renewcommand{\thetheorem}{B1}
\begin{theorem}[\hspace{2sp}Theorem 15.3 in \citep{levin08book}] \label{lem:gibbs_exp}
  If $\beta > 1$, then the Gibbs sampler on \isingb{} has a bottleneck ratio $\Phi_{*} = \bO\left(e^{-c(\beta)n}\right)$, where $c(\beta)$ is a non-decreasing function of $\beta$.
\end{theorem}
\let\thetheorem\oldthetheorem

\setcounter{cor}{0}
\begin{cor}[cf. Theorem 15.3 in \citep{levin08book}]
  For $n \geq 3$, the Gibbs sampler on \ising{} has spectral gap $\gg = \bO\left(e^{-cn}\right)$, where $c > 0$ is a constant.
\end{cor}

\begin{cor}[cf. Theorem 2 in \citep{ding09}]
  For all $n \geq 3$, the restriction chains $\Pg_i$, $i = 0, 1$, of the Gibbs sampler on \ising{} have spectral gap $\gg_i = \Theta\left(\displaystyle\frac{2\ln(n) - 1}{n}\right)$.
\end{cor}

\subsection{Bounds on \Ms{} mixing}
\paragraph{\Ms{} sampler.}
The proposal distribution can be written as follows,
\begin{align} \label{eq:qdef}
  q(S) = \frac12\left( \frac{\exp(-\dn (n-1)|S|)}{Z_1} + \frac{\exp(\dn (n-1)|S|)}{Z_2}\right),
\end{align}
where $Z_1 = \left(1 + \exp(-\dn(n-1))\right)^n$, and $Z_2 = \left(1 + \exp(\dn(n-1))\right)^n$.

\let\oldthelemma\thelemma
\renewcommand{\thelemma}{B1}
\begin{lemma} [Fact 6 in \citep{anari16}] \label{lem:anari}
  The spectral gap of any reversible two-state chain $P$ with stationary distribution $\pi$ that satisfies $P(0, 1) = c\,\pi(1)$ is $c$.
\end{lemma}
\let\thelemma\oldthelemma

\setcounter{lemma}{0}
\begin{lemma}
  For all $n \geq 10$, the projection chain $\bPm$ of the \Ms{} sampler on \ising{} has spectral gap $\bgm = \Omega(1)$.
\end{lemma}

\begin{proof}
We define $\pi_k = \sum_{S \in \Omega, |S| = k} \pi(S)$, and $q_k = \sum_{S \in \Omega, |S| = k} q(S)$.

\paragraph{Bounding $\pi_k$.}
By definition, we can write $\pi_k = \hat{\pi}_k / Z$, where $\hat{\pi}_0 = 1$, and for $k > 0$ we have
\begin{align*}
\hat{\pi}_k &\defeq \binom{n}{k} \exp\left(-\frac{2\ln(n)}{n} k(n-k)\right)\\
            &= \binom{n}{k} n^{-\frac{2k}{n} (n-k)}\\
            &\leq \left(\frac{en}{k}\right)^k n^{-\frac{2k}{n} (n-k)}\\
            &= \left(\frac{e}{k}\right)^k n^{-k + \frac{2k^2}{n}}.
\end{align*}
It follows that
\begin{align} \label{eq:logpk}
  \ln(\hat{\pi}_k) \leq -k \ln\left(\frac{k}{e}\right) + \left(\frac{2k^2}{n} - k\right)\ln(n).
\end{align}
It is easy to verify that for all $n \geq 10$ and $3 \leq k \leq \lfloor n/2 \rfloor$, it holds that $(2k-n)\ln(n) \leq 0.5n\ln(k/e)$.
Substituting this into \eqref{eq:logpk}, we get
\begin{align*}
            \ln(\hat{\pi}_k) &\leq -0.5k\ln\left(\frac{k}{e}\right)\\
  \Rightarrow\ \ \hat{\pi}_k &\leq \exp(-0.5k\ln(k/e)).
\end{align*}
Noting that, for all $k$, $\hat{\pi}_k \leq 1$, and using the fact that $\hat{\pi}_{n-k} = \hat{\pi}_k$, we get
\begin{align}
  Z &= \sum_{k = 0}^n \hat{\pi}_k \nonumber\\ 
    &\leq 2\sum_{k = 0}^{\lfloor n/2 \rfloor} \hat{\pi}_ k\nonumber\\
    &= 2(\hat{\pi}_0 + \hat{\pi}_1 + \hat{\pi}_2 + \sum_{k = 3}^{\lfloor n/2 \rfloor} \hat{\pi}_k) \nonumber\\
    &\leq 3 + \sum_{k = 3}^{\lfloor n/2 \rfloor} \exp(-0.5k\ln(k/e)) \nonumber\\
    &\leq c_1, \label{eq:Zconst}
\end{align}
where $c_1$ is a constant.

\paragraph{Bounding $q_k$.}
First, it is easy to see that, for all $n \geq 1$, $Z_1 \leq 3$.
\begin{align*}
  q_k &= \sum_{S \in \Omega, |S| = k} q(S)\\
      &\geq \sum_{S \in \Omega, |S| = k} \frac{1}{2} \frac{\exp(-\dn (n-1)|S|)}{Z_1} \tag{by \eqref{eq:qdef}} \\
      &\geq \frac{1}{6} \binom{n}{k} \exp(-\dn (n-1)|S|)
\end{align*}

\paragraph{Bounding the spectral gap.}
For the projection chain $\bPm$, we have
\begin{align*}
\bPm(0, 1) &= \frac{1}{\bar{\pi}(0)} \sum_{\subalign{S &\in \Omega_i\\ R &\in \Omega_j}} \pi(S) \Pm(S, R)\\
           %&\geq \frac{1}{\bar{\pi}(0)} \sum_{\subalign{S &\in \Omega_i\\ R &\in \Omega_j\\ |R| &= |V \setminus S|}} \pi(S) \Pm(S, R)\\
           %&\geq \frac{1}{\bar{\pi}(0)} \sum_{\subalign{S &\in \Omega_i\\ R &\in \Omega_j\\ |R| &= |V \setminus S|}} \pi(S) q(R)\displaystyle\frac{\pi(R)q(S)}{\pi(S)q(R)}\\ \tag{$\pi(R) = \pi(S)$ and $q(R) = q(S)$}
           %&\geq \frac{1}{\bar{\pi}(0)} \sum_{\subalign{S &\in \Omega_i\\ R &\in \Omega_j\\ |R| &= |V \setminus S|}} \pi(S) q(R)\\
           %&\geq \frac{1}{\bar{\pi}(0)} \sum_{k = 0}^{\lfloor n/2 \rfloor} \pi_k q_{n-k}\\
           %&= \frac{1}{\bar{\pi}(0)} \sum_{k = 0}^{\lfloor n/2 \rfloor} \pi_k q_{k} \tag{by symmetry of $q_k$}\\
           %&= 2 \sum_{k = 0}^{\lfloor n/2 \rfloor} \pi_k q_{k} \tag{$\bar{\pi}(0) = 1/2$ by symmetry of $\pi$} \\
           &\geq 2\pi_0 q_n \tag{$\bar{\pi}(0) = 1/2$ by symmetry of $\pi$}\\
           &= 2\pi_0 q_0 \tag{by symmetry of $q$}\\
           &\geq 2\frac{\hat{\pi}_0}{Z} \frac{1}{6} \tag{$q_0 \geq \frac{1}{6}$}\\
           &\geq 2\frac{1}{c_1}\frac{1}{6} \tag{$\hat{\pi}_0 = 1$}\\
           &= c \bar{\pi}(1),
\end{align*}
where $c = (2/3)c_1$.

Finally, it follows from \lemmaref{lem:anari} that the spectral gap of $\bPm$ is $c$.

\end{proof}

\subsection{Bounds on combined sampler mixing}

\let\oldthelemma\thelemma
\renewcommand{\thelemma}{B2}
\begin{lemma} \label{lem:cproj}
  For all $n \geq 10$, the projection chain $\bPc$ of the combined chain on \ising{} has spectral gap $\bgc = \Omega(1).$
\end{lemma}
\let\thelemma\oldthelemma

\begin{proof}
  By definition, $\bPc(S, R) \geq \alpha \bPm(S, R)$, therefore a simple comparison argument (e.g., Lemma 13.22 in \citep{levin08book}) combined with the result of \lemmaref{lem:mproj} gives us $\bgc \geq \alpha \bgm = \Omega(1)$.
\end{proof}

\let\oldthelemma\thelemma
\renewcommand{\thelemma}{B3}
\begin{lemma} \label{lem:crest}
  For all $n \geq 3$, each of the restriction chains $\Pc_i$ of the combined chain on \ising{} has spectral gap $\gc_i = \Theta\left(\displaystyle\frac{2\ln(n) - 1}{2n}\right)$.
\end{lemma}
\let\thelemma\oldthelemma

\begin{proof}
  By definition, $\Pc_i(S, R) \geq \alpha \Pg_i(S, R)$, therefore, using a comparison argument like above together with \lemmaref{thm:grest} gives us $\gc_i \geq \alpha \gg_i = \Theta\left(\displaystyle\frac{2\ln(n) - 1}{2n}\right)$.
\end{proof}

\let\oldthetheorem\thetheorem
\renewcommand{\thetheorem}{B2}
\begin{theorem}[\hspace{2sp}Theorem 1 in \citep{jerrum04poincare}] \label{thm:jerrum04}
  Given a reversible Markov chain $P$, if the spectral gap of its projection chain $\bar{P}$ is bounded below by $\bar{\gamma}$, and the spectral gaps of its restriction chains $P_i$ are uniformly bounded below by $\gamma_{\textrm{min}}$, then the spectral gap of $P$ is bounded below by
  \begin{align*}
    \gamma = \min\left\{ \frac{\bar{\gamma}}{3}, \frac{\bar{\gamma}\gamma_{\textrm{min}}}{3\Pmax + \bar{\gamma}} \right\},
  \end{align*}
  where $p_{\textrm{max}} \defeq \displaystyle\max_{i \in \{0, 1\}}\max_{S \in \Omega_i} \sum_{R \in \Omega \setminus \Omega_i} P(S, R)$.
\end{theorem}
\let\thetheorem\oldthetheorem

\setcounter{theorem}{1}
\begin{theorem}
  For all $n \geq 10$, the combined chain $\Pc$ on \ising{} has spectral gap
  \begin{align*}
    \gc = \Omega\left( \displaystyle\frac{2\ln(n) - 1}{2n} \right).
  \end{align*}
\end{theorem}

\begin{proof}
  The result follows directly by combining the spectral gap bounds of \lemmasref{lem:cproj} and \ref{lem:crest} in \theoremref{thm:jerrum04}, and noting that $\Pmax \leq 1$.
\end{proof}